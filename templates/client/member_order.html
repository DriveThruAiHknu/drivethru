<html>

<head>
    <title> í‚¤ì˜¤ìŠ¤í¬ </title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

{% load static %}
<script src="http://code.jquery.com/jquery-latest.js"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="{% static 'client/style/member_order_style.css' %}">


<body>

    <div class="container" id="full_content">
        <!-- ai -->
        <div class="row justify-content-center mb-4" id="bot">
            <div class="ai_img col-sm-3"></div>
            <div class="ai_txt col-sm-9">
                <h2 id="ai_say">ğŸŒ¿ì–´ì„œì˜¤ì„¸ìš”! ìŠ¤íƒ€ë²…ìŠ¤ì…ë‹ˆë‹¤ğŸŒ¿</h2>
            </div>
        </div>

        <!-- ì™¼ìª½ ë©”ë‰´ / ì˜¤ë¥¸ìª½ ì˜ìˆ˜ì¦-->
        <div class="row h-75">


            <!-- ì™¼ìª½ ë©”ë‰´ë“¤-->
            <div class="col-xxl-6" id="left">
                <div class="container">

                    <!-- ìµœê·¼ ì£¼ë¬¸ ë©”ë‰´-->
                    <div class="row">
                        <div class="container-fluid">
                            <h4 id="menu_txt" class="mb-3"> ìµœê·¼ ì£¼ë¬¸ ë©”ë‰´</h4>
                            <div class="row justify-content-around">
                                <!-- ìƒí’ˆ 1, 2-->

                                <!-- ìƒí’ˆ1 -->
                                <div class="col-md-6" id="item1">
                                    <div class="image1"></div>
                                    <div class="menu_item">
                                        <div class="image_num text-center">
                                            <h4 class="text-center mt-1">1</h4>
                                        </div>
                                        <h5 class="menu_name mt-2" id="new_1_id">ì¹´í˜ ì•„ë©”ë¦¬ì¹´ë…¸
                                            <span class="badge bg-primary">Ice</span>
                                        </h5>
                                    </div>
                                    <h5 class="menu_price">
                                        <button type="none" class="btn-btn-outline-primary">$</button>
                                        4.3
                                    </h5>
                                </div>

                                <!-- ìƒí’ˆ2 -->
                                <div class="col-md-6" id="item2">
                                    <div class="image2"></div>
                                    <div class="menu_item">

                                        <div class="image_num text-center">
                                            <h4 class="text-center mt-1">2</h4>
                                        </div>
                                        <h5 class="menu_name mt-2" id="new_2_id">ì¹´í‘¸ì¹˜ë…¸
                                            <span class="badge bg-danger">Hot</span>
                                        </h5>
                                        <h5 class="menu_price">
                                            <button type="none" class="btn-btn-outline-primary">$</button>
                                            5.4
                                        </h5>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>


                    <!-- ìµœë‹¤ ì£¼ë¬¸ ë©”ë‰´-->
                    <div class="row">
                        <div class="container-fluid">
                            <h4 class="mt-5 mb-3" id="menu_txt"> ìµœë‹¤ ì£¼ë¬¸ ë©”ë‰´</h4>
                            <div class="row">
                                <!-- ìƒí’ˆ 3, 4, 5, 6-->

                                <!-- ìƒí’ˆ3 -->
                                <div class="col" id="item3">
                                    <div class="image3"></div>
                                    <div class="menu_item">
                                        <div class="image_num text-center">
                                            <h4 class="text-center mt-1">3</h4>
                                        </div>
                                        <h5 class="menu_name mt-2" id="new_3_id">ì¹´í˜ë¼ë–¼
                                            <span class="badge bg-primary">Ice</span>
                                        </h5>
                                    </div>
                                    <h5 class="menu_price">
                                        <button type="none" class="btn-btn-outline-primary">$</button>
                                        4.4
                                    </h5>
                                </div>

                                <!-- ìƒí’ˆ4 -->
                                <div class="col" id="item4">
                                    <div class="image4"></div>
                                    <div class="menu_item">
                                        <div class="image_num text-center">
                                            <h4 class="text-center mt-1">4</h4>
                                        </div>
                                        <h5 class="menu_name mt-2" id="new_4_id">ì½”ì½”ì•„
                                            <span class="badge bg-danger">Hot</span>
                                        </h5>
                                        <h5 class="menu_price">
                                            <button type="none" class="btn-btn-outline-primary">$</button>
                                            3.5
                                        </h5>
                                    </div>
                                </div>

                                <!-- ìƒí’ˆ5 -->
                                <div class="col" id="item5">
                                    <div class="image5"></div>
                                    <div class="menu_item">
                                        <div class="image_num text-center">
                                            <h4 class="text-center mt-1">5</h4>
                                        </div>
                                        <h5 class="menu_name mt-2" id="new_5_id">ê³¡ë¬¼ ë¹µ
                                            <span class="badge bg-info">Food</span>
                                        </h5>
                                        <h5 class="menu_price">
                                            <button type="none" class="btn-btn-outline-primary">$</button>
                                            4.1
                                        </h5>
                                    </div>
                                </div>

                                <!-- ìƒí’ˆ6 -->
                                <div class="col" id="item6">
                                    <div class="image6"></div>
                                    <div class="menu_item">
                                        <div class="image_num text-center">
                                            <h4 class="text-center mt-1">6</h4>
                                        </div>
                                        <h5 class="menu_name mt-2" id="new_6_id">ë³µìˆ­ì•„ í‹°
                                            <span class="badge bg-danger">Hot</span>
                                        </h5>
                                        <h5 class="menu_price">
                                            <button type="none" class="btn-btn-outline-primary">$</button>
                                            4.8
                                        </h5>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <!-- ì˜¤ë¥¸ìª½ ì˜ìˆ˜ì¦-->
            <div class="col-xxl-6" id="right">


                <h4 id="menu_txt" class="mb-3">ì£¼ë¬¸ ëª©ë¡</h4>
                <div class="container-fluid" id="menu_table">
                    <table>

                        <tr>
                            <div class="row" id="title">
                                <div class="col-md-8">
                                    <h3 class="text-center">ì£¼ë¬¸í•˜ì‹  ë©”ë‰´</h3>
                                </div>
                                <div class="col-md-2">
                                    <h3 class="text-center">ìˆ˜ëŸ‰</h3>
                                </div>
                                <div class="col-md-2">
                                    <h3 class="text-center">ê°€ê²©</h3>
                                </div>
                            </div>

                        </tr>


                        <div id="content"></div>

                    </table>
                    <div class="row">
                        <div class="col-md-6 text-center" id="border3">
                            <h3 id="total_txt">ì£¼ë¬¸ ê¸ˆì•¡</h3>
                        </div>
                        <div class="col-md-6 text-center" id="border2">
                            <h3 id="total_real">0 ì›</h3>
                        </div>
                    </div>




                </div>
            </div>
        </div>

    </div>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"></script>

    <script>


        /* ë©”ì¸ */
        var morpheme_list = new Array(); //í˜•íƒœì†Œ ë¦¬ìŠ¤íŠ¸ ì €ì¥
        var before_list = new Array(); //ì£¼ë¬¸ ë¦¬ìŠ¤íŠ¸ [ë©”ë‰´ì´ë¦„, ê°€ê²©, ìˆ˜ëŸ‰, ì˜¨ë„, ì¹´í˜ì¸, ì‹œëŸ½, ìƒ·, ìš°ìœ , íœ˜í•‘, ìë°”ì¹©, ë“œë¦¬ì¦]
        var user_op_list = new Array();
        var after_list = new Array(); //ì‹¤ì œ ì£¼ë¬¸ ì™„ì„± ë¦¬ìŠ¤íŠ¸ [ë©”ë‰´ì´ë¦„, ê°€ê²©, ì‚¬ì´ì¦ˆ, ìˆ˜ëŸ‰, ì˜¨ë„, ì¹´í˜ì¸, ì‹œëŸ½, ìƒ·, ìš°ìœ , íœ˜í•‘, ìë°”ì¹©, ë“œë¦¬ì¦]
        var txt = document.getElementById("ai_say");
        var forms = document.getElementById("content");
        var forms_txt = '';
        var total_real = document.getElementById("total_real");

        var price_list = new Array(); //ìƒí’ˆ 1ê°œ ê°€ê²©*ìˆ˜ëŸ‰ + ì˜µì…˜
        var morpheme_str = "";
        var menu_price = 0;
        var total_price = 0;


        txt.innerHTML = "ğŸŒ¿ì–´ì„œì˜¤ì„¸ìš”! ìŠ¤íƒ€ë²…ìŠ¤ì…ë‹ˆë‹¤ğŸŒ¿";

        window.onload = function () {
            setTimeout(() => {
                order();
            }, 1000);
        }

        /* ë°ì´í„°ë² ì´ìŠ¤ ê°€ì ¸ì˜¤ê¸° */
        var db_str = '{{ prods|escapejs }}';
        var db_list = db_str.slice(1, -1);
        db_list = db_list.split('),');

        //ë°ì´í„°ë² ì´ìŠ¤ - ì „ì²´(db)
        var db = new Array();
        for (var i = 0; i < db_list.length; i++) {
            db.push(db_list[i].replace(/\'|\"|\(|\)| /g, "").split(','));
        }

        //ë°ì´í„°ë² ì´ìŠ¤ - ë©”ë‰´(db_menu)
        var db_menu = new Array();
        for (var j = 0; j < db.length; j++) {
            db_menu.push(db[j][2]);
        }

        //ë°ì´í„°ë² ì´ìŠ¤ - ê°€ê²©(db_price)
        var db_price = new Array();
        for (var k = 0; k < db.length; k++) {
            db_price.push(db[k][3]);
        }

        /* fetchë¡œ viewì— ìˆëŠ” ë¶„ì„ê¸°ë¡œ ë¬¸ì¥ ë³´ë‚´ëŠ” í•¨ìˆ˜ */
        function stem_analyzer(resText) {
            var url = "http://localhost:8000/client/analyzer?resText=" + resText
            return fetch(url, {
                headers: { 'Content-Type': 'application/json; charset=utf-8' },
                body: JSON.stringify(this.obj)
            }).then(response => response.json())
                .then(res => {//console.log("ê°ì²´",res);
                    var str = JSON.stringify(res);
                    var str_slice = str.slice(1, -1).replace(/\'|\"|\\/g, '');
                    str_slice = str_slice.split(',');
                    morpheme_list = str_slice;
                    morpheme_str = str_slice;
                    //console.log('ë¦¬ìŠ¤íŠ¸:', morpheme_list);
                    //console.log('ë¬¸ì:', morpheme_str);
                    return morpheme_str;
                })
        }

        /* ì‹¤ì œ ë¹„ë™ê¸° ì²˜ë¦¬ ì½”ë“œ */
        async function order() {
            var audio_once = false; //í•œë²ˆì´ë¼ë„ ì£¼ë¬¸í–ˆëŠ”ì§€

            try {
                var audio1 = await tts("ì–´ì„œì˜¤ì„¸ìš”. ìŠ¤íƒ€ë²…ìŠ¤ì…ë‹ˆë‹¤!");

                txt.innerHTML = "ì£¼ë¬¸ì„ ì›í•˜ì‹œëŠ” ë©”ë‰´ë‚˜ ë²ˆí˜¸ë¥¼ ë§ì”€í•´ì£¼ì„¸ìš”ğŸ’š";
                var audio2 = await tts("ì£¼ë¬¸ì„ ì›í•˜ì‹œëŠ” ë©”ë‰´ë‚˜ ë²ˆí˜¸ë¥¼ ë§ì”€í•´ì£¼ì„¸ìš”!");

                txt.innerHTML = "ì¸ì‹ ì¤‘ ...!"; //ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ ë“¤ì–´ê°€ë©´ ì¢‹ì„ ê±° ê°™ìŒ

                var audio_once = true;

                while (true) {
                    if (audio_once) // ì£¼ë¬¸í•œì  X
                    {
                        console.log("ì£¼ë¬¸í•œ ì  X");
                        var stt1 = await speech_to_text();

                        if (stt1.length > 1) //í•œ ê¸€ì ì´ìƒ ë“¤ì–´ì˜¤ë©´
                        {

                            txt.innerHTML = "âœ…" + stt1;

                            /* í˜•íƒœì†Œ ë¶„ì„ê¸° ì‹¤í–‰ */
                            var stt_morpheme = await stem_analyzer(stt1);
                            //console.log("return: ",stt_morpheme); -> ì•„ë©”ë¦¬ì¹´ë…¸,í•˜ë‚˜
                            console.log("ì „ì—­ í˜¸ì¶œ: ", morpheme_list); //-> [ì•„ë©”ë¦¬ì¹´ë…¸,í•˜ë‚˜]
                            //console.log("ì „ì—­ í˜¸ì¶œ ë¬¸ì: ", morpheme_str); -> ì•„ë©”ë¦¬ì¹´ë…¸,í•˜ë‚˜


                            /* DBì— ìˆëŠ”ì§€ ë©”ë‰´ ì¡°íšŒ */
                            for (var x = 0; x < morpheme_list.length; x++) {
                                for (var y = 0; y < db_menu.length; y++) {
                                    if (morpheme_list[x] == db_menu[y]) {
                                        console.log('ë©”ë‰´ ì¸ì‹ ì™„ë£Œ : ');
                                        //6 hot_cold, 7 caf_amount, 8 syrup, 9 shot, 10 milk, 11 whip, 12 java_chip, 13 driz,
                                        before_list.push([db_menu[y], db_price[y], db[y][6], db[y][7], db[y][8], db[y][9], db[y][10], db[y][11], db[y][12], db[y][13]])

                                        break;
                                    }
                                    else //ë©”ë‰´ ì¸ì‹ ëª»í•¨
                                    {
                                        //...
                                    }
                                }
                            }


                            /* ì‚¬ìš©ìê°€ ë§í•œ ì˜µì…˜ */
                            var user_hot_cold = "";
                            var user_caf_amount = "";
                            var user_syrup = "";
                            var user_shot = "";
                            var user_milk = "";
                            var user_whip = "";
                            var user_java_chip = "";
                            var user_driz = "";
                            var user_sales_rate = "";
                            var user_size = "";


                            for (var z = 0; z < morpheme_list.length; z++) {
                                /* ì‚¬ìš©ìê°€ ë§í•œ ë©”ë‰´ ì˜µì…˜!! */
                                //!!!!!!!!!!!!!!!!! ë‚˜ì¤‘ì— ì„ë² ë”© ì—°ê²°í•˜ë©´ case ê°’ ë°”ê¾¸ê¸°

                                //1. ì˜¨ë„
                                if (morpheme_list[z] == 'í•«') {
                                    user_hot_cold = "H";
                                }
                                else if (morpheme_list[z] == 'ì•„ì´ìŠ¤') {
                                    user_hot_cold = "C";
                                }

                                //ì˜ˆì™¸ì²˜ë¦¬
                                if ((Number(before_list[before_list.length - 1][2]) == 1) && (user_hot_cold == "C")) //í•«
                                {
                                    alert("Hotë§Œ ê°€ëŠ¥í•œ ë©”ë‰´ì…ë‹ˆë‹¤");
                                    user_hot_cold = "H";
                                }
                                else if ((Number(before_list[before_list.length - 1][2]) == 2) && (user_hot_cold == "H")) //ì½œë“œ
                                {
                                    alert("Coldë§Œ ê°€ëŠ¥í•œ ë©”ë‰´ì…ë‹ˆë‹¤");
                                    user_hot_cold = "C";
                                }

                                //ì•„ë¬´ ê°’ë„ ì•ˆë“¤ì–´ì˜¤ë©´
                                if (user_hot_cold == "") {
                                    if (Number(before_list[before_list.length - 1][2]) == 1) {
                                        user_hot_cold = "H";
                                    }
                                    else if (Number(before_list[before_list.length - 1][2]) == 2) {
                                        user_hot_cold = "C";
                                    }
                                    else if (Number(before_list[before_list.length - 1][2]) == 3) {
                                        //ë‘˜ ë‹¤ ê°€ëŠ¥í•˜ë©´ Iceë¡œ!
                                        user_hot_cold = "C";
                                    }
                                }

                                //2. ì¹´í˜ì¸ ì¡°ì ˆ
                                if (morpheme_list[z] == 'ì¹´í˜ì¸') {
                                    user_caf_amount = 'CC';
                                }
                                else if (morpheme_list[z] == 'ë””ì¹´í˜ì¸') {
                                    user_caf_amount = 'CD';
                                }
                                else if (morpheme_list[z] == 'í•˜í”„ë””ì¹´í˜ì¸') {
                                    user_caf_amount = 'CH';
                                }

                                //ì˜ˆì™¸ì²˜ë¦¬
                                if ((before_list[before_list.length - 1][3] == 'False') && (user_caf_amount != "")) //ì¹´í˜ì¸ ì¡°ì ˆ ë¶ˆê°€ëŠ¥
                                {
                                    alert("ì¹´í˜ì¸ ì¡°ì ˆì´ ë¶ˆê°€ëŠ¥í•œ ë©”ë‰´ì…ë‹ˆë‹¤");
                                    user_caf_amount = "";
                                }

                                //3. ì‹œëŸ½ ì¡°ì ˆ
                                if ((morpheme_list[z] == 'ë°”ë‹ë¼') || (morpheme_list[z] == 'ë°”ë‹ë¼ì‹œëŸ½')) {
                                    if (Number(morpheme_list[z + 1] != NaN)) {
                                        user_syrup = 'B' + Number(morpheme_list[z + 1])
                                    }
                                    else {
                                        user_syrup = 'B2';
                                    }
                                }
                                else if ((morpheme_list[z] == 'í—¤ì´ì¦ë„›') || (morpheme_list[z] == 'í—¤ì´ì¦ë„›ì‹œëŸ½')) {
                                    if (Number(morpheme_list[z + 1] != NaN)) {
                                        user_syrup = 'H' + Number(morpheme_list[z + 1])
                                    }
                                    else {
                                        user_syrup = 'H2';
                                    }
                                }
                                else if ((morpheme_list[z] == 'ì¹´ë¼ë©œ') || (morpheme_list[z] == 'ì¹´ë¼ë©œì‹œëŸ½')) {
                                    if (Number(morpheme_list[z + 1] != NaN)) {
                                        user_syrup = 'C' + Number(morpheme_list[z + 1])
                                    }
                                    else {
                                        user_syrup = 'C2';
                                    }
                                }

                                //ì˜ˆì™¸ì²˜ë¦¬
                                if (Number(before_list[before_list.length - 1][4] == 0) && (user_syrup != "")) //ì‹œëŸ½ ì¡°ì ˆ ë¶ˆê°€ëŠ¥
                                {
                                    alert("ì‹œëŸ½ ì¡°ì ˆì´ ë¶ˆê°€ëŠ¥í•œ ë©”ë‰´ì…ë‹ˆë‹¤");
                                    user_syrup = "";
                                }


                                //4. ìƒ· ì¡°ì ˆ -> ì„ ì—†ì• ê¸°
                                if ((morpheme_list[z] == 'ìƒ·') || (morpheme_list[z] == 'ì„')) {
                                    if (Number(morpheme_list[z + 1] != NaN)) {
                                        user_shot = 'S' + Number(morpheme_list[z + 1])
                                    }
                                    else {
                                        user_shot = 'S1';
                                    }
                                }

                                //ì˜ˆì™¸ì²˜ë¦¬
                                if ((before_list[before_list.length - 1][5] == 'False') && (user_shot != "")) //ìƒ· ì¡°ì ˆ ë¶ˆê°€ëŠ¥
                                {
                                    alert("ìƒ· ì¡°ì ˆì´ ë¶ˆê°€ëŠ¥í•œ ë©”ë‰´ì…ë‹ˆë‹¤");
                                    user_shot = "";
                                }


                                //5. ìš°ìœ  ì¡°ì ˆ
                                if (morpheme_list[z].indexOf('ì €ì§€ë°©') >= 0) { //indexOf í¬í•¨ ë¬¸ìì—´ ìˆìœ¼ë©´ í•´ë‹¹ ì¸ë±ìŠ¤, ì—†ìœ¼ë©´ -1 ë°˜í™˜
                                    user_milk = 'ML';
                                }
                                else if (morpheme_list[z].indexOf('ë¬´ì§€ë°©') >= 0) {
                                    user_milk = 'MN';
                                }
                                else if (morpheme_list[z].indexOf('ë‘ìœ ') >= 0) {
                                    user_milk = 'MS';
                                }
                                else if ((morpheme_list[z].indexOf('ê·€ë¦¬') >= 0) || (morpheme_list[z].indexOf('ì˜¤íŠ¸') > 0)) {
                                    user_milk = 'MO';
                                }

                                //ì˜ˆì™¸ì²˜ë¦¬
                                if ((before_list[before_list.length - 1][6] == 'False') && (user_milk != "")) //ìš°ìœ  ì¡°ì ˆ ë¶ˆê°€ëŠ¥
                                {
                                    alert("ìš°ìœ  ì¡°ì ˆì´ ë¶ˆê°€ëŠ¥í•œ ë©”ë‰´ì…ë‹ˆë‹¤");
                                    user_milk = "";
                                }


                                //6. íœ˜í•‘ ì¡°ì ˆ
                                if (morpheme_list[z].indexOf('íœ˜í•‘') >= 0) {

                                    //ì—ìŠ¤í”„ë ˆì†Œ íœ˜í•‘ì¸ì§€ ê·¸ëƒ¥ íœ˜í•‘ì¸ì§€
                                    if (morpheme_list[z - 1] == 'ì—ìŠ¤í”„ë ˆì†Œ') {
                                        user_whip = 'EW';
                                    }
                                    else {
                                        user_whip = 'W';
                                    }

                                    // ì–‘ì€ ì–¼ë§ˆë‚˜ í• ê±´ì§€
                                    if (morpheme_list[z + 1].indexOf('ë§') >= 0) {
                                        user_whip += '3';
                                    }
                                    else if ((morpheme_list[z + 1] == 'ì ê²Œ') || (morpheme_list[z + 1] == 'ì¡°ê¸ˆ') || (morpheme_list[z + 1] == 'ì•½ê°„')) {
                                        user_whip += '1';
                                    }
                                    else { //ë§ ì•ˆí•˜ë©´ ë³´í†µ
                                        user_whip += '2';
                                    }
                                }

                                //ì˜ˆì™¸ì²˜ë¦¬
                                if ((before_list[before_list.length - 1][7] == 'False') && (user_whip != "")) //íœ˜í•‘ ì¡°ì ˆ ë¶ˆê°€ëŠ¥
                                {
                                    alert("íœ˜í•‘ ì¡°ì ˆì´ ë¶ˆê°€ëŠ¥í•œ ë©”ë‰´ì…ë‹ˆë‹¤");
                                    user_whip = "";
                                }


                                //7. ìë°”ì¹© ì¡°ì ˆ
                                if (morpheme_list[z].indexOf('ìë°”ì¹©') >= 0) {
                                    if ((morpheme_list[z - 1].indexOf('í†µ') >= 0) || (morpheme_list[z].indexOf('í†µ') >= 0) || (morpheme_list[z + 1].indexOf('í†µ') >= 0)) {
                                        user_java_chip = 'JCA'; //í†µìë°”ì¹© í† í•‘
                                    }
                                    else {
                                        user_java_chip = 'JC'; //ì¼ë°˜ ìë°”ì¹© í† í•‘
                                    }
                                }

                                //ì˜ˆì™¸ì²˜ë¦¬
                                if ((before_list[before_list.length - 1][8] == 'False') && (user_java_chip != "")) //ìë°”ì¹© ì¡°ì ˆ ë¶ˆê°€ëŠ¥
                                {
                                    alert("ìë°”ì¹© ì¡°ì ˆì´ ë¶ˆê°€ëŠ¥í•œ ë©”ë‰´ì…ë‹ˆë‹¤");
                                    user_java_chip = "";
                                }


                                //8. ë“œë¦¬ì¦ ì¡°ì ˆ
                                if (morpheme_list[z].indexOf('ë“œë¦¬ì¦') >= 0) {

                                    //ì¹´ë¼ë©œì¸ì§€ ì´ˆì½œë¦¿ì¸ì§€
                                    if ((morpheme_list[z - 1] == 'ì¹´ë¼ë©œ') || (morpheme_list[z] == 'ì¹´ë¼ë©œ')) {
                                        user_driz = 'DCR';
                                    }
                                    else {
                                        user_driz = 'DCC';
                                    }

                                    // ì–‘ì€ ì–¼ë§ˆë‚˜ í• ê±´ì§€
                                    if (morpheme_list[z + 1].indexOf('ë§') >= 0) {
                                        user_whip += '3';
                                    }
                                    else if ((morpheme_list[z + 1] == 'ì ê²Œ') || (morpheme_list[z + 1] == 'ì¡°ê¸ˆ') || (morpheme_list[z + 1] == 'ì•½ê°„')) {
                                        user_whip += '1';
                                    }
                                    else if (morpheme_list[z + 1] == 'ë³´í†µ') {
                                        user_whip += '2';
                                    }
                                    else { //ë§ ì•ˆí•˜ë©´ ë³´í†µ
                                        user_whip += '2';
                                    }
                                }

                                //ì˜ˆì™¸ì²˜ë¦¬
                                if ((before_list[before_list.length - 1][9] == 'False') && (user_driz != "")) //ë“œë¦¬ì¦ ì¡°ì ˆ ë¶ˆê°€ëŠ¥
                                {
                                    alert("ë“œë¦¬ì¦ ì¡°ì ˆì´ ë¶ˆê°€ëŠ¥í•œ ë©”ë‰´ì…ë‹ˆë‹¤");
                                    user_driz = "";
                                }


                                //9. ì‚¬ì´ì¦ˆ
                                if (morpheme_list[z] == 'ìˆ') {
                                    user_size = "S";
                                }
                                else if (morpheme_list[z] == 'í†¨') {
                                    user_size = "T";
                                }
                                else if (morpheme_list[z] == 'ê·¸ë€ë°') {
                                    user_size = "G";
                                }

                                //ì•„ë¬´ ê°’ë„ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’
                                if (user_size == "") {
                                    user_size = "T";
                                }
                            }

                            //user_op_list = (ì˜¨ë„)H/C, (ì¹´í˜ì¸)CC/CH/CD, (ì‹œëŸ½)Bìˆ«ì/Hìˆ«ì/Cìˆ«ì, 
                            //(ìƒ·)Sìˆ«ì, (ìš°ìœ )ML/MN/MS/MO, (íœ˜í•‘)EW1~3/W1~3, (ìë°”ì¹©)JCA/JC, (ë“œë¦¬ì¦)DCR1~3/DCC1~3, (ì‚¬ì´ì¦ˆ) S/T/G

                            user_op_list.push([user_hot_cold, user_caf_amount, user_syrup, user_shot, user_milk, user_whip,
                                user_java_chip, user_driz, user_size]);

                            console.log("ì‚¬ìš©ìê°€ ì¶”ê°€í•œ ì˜µì…˜ : ", user_op_list);



                            var audio3 = await tts(before_list[before_list.length - 1][0]/* menu_list[menu_list.length - 1] */ + "\në©”ë‰´ë¥¼ ì„ íƒí•˜ì…¨ìŠµë‹ˆë‹¤!");

                            console.log('ì¶”ê°€ëœ ë©”ë‰´', before_list[before_list.length - 1][0]);
                            console.log('ë©”ë‰´ ê°€ê²©', before_list[before_list.length - 1][1]);
                            console.log('ì¶”ê°€ëœ ì˜µì…˜', user_op_list);

                            /* ì‹¤ì œ ì˜µì…˜ */
                            var menu = "";
                            var price = 0;
                            var menu_ea = 1;

                            var hot_cold = "";
                            var caf_amount = "";
                            var syrup = "";
                            var shot = "";
                            var milk = "";
                            var whip = "";
                            var java_chip = "";
                            var driz = "";
                            var sales_rate = "";
                            var size = "";
                            var ul = "<ul>";
                            var op_price = 0;


                            //6 hot_cold, 7 caf_amount, 8 syrup, 9 shot, 10 milk, 11 whip, 12 java_chip, 13 driz,
                            /* before_list.push([db_menu[y], db_price[y], db[y][6], db[y][7], db[y][8], db[y][9], db[y][10], db[y][11], db[y][12], db[y][13]]) */

                            /* var after_list = new Array();  */
                            //ì‹¤ì œ ì£¼ë¬¸ ì™„ì„± ë¦¬ìŠ¤íŠ¸ [ë©”ë‰´ì´ë¦„, ê°€ê²©, ìˆ˜ëŸ‰, ì˜¨ë„, ì¹´í˜ì¸, ì‹œëŸ½, ìƒ·, ìš°ìœ , íœ˜í•‘, ìë°”ì¹©, ë“œë¦¬ì¦, ì‚¬ì´ì¦ˆ, ì˜µì…˜ê°€ê²©, ì´ê°€ê²©]

                            //1,2,3. ë©”ë‰´ì´ë¦„, ê°€ê²©, ì‚¬ì´ì¦ˆ
                            menu = before_list[before_list.length - 1][0];
                            price = Number(before_list[before_list.length - 1][1]);
                            size = user_op_list[user_op_list.length - 1][8];

                            if (size == 'T') {
                                op_price += 500;
                            }
                            else if (size == 'G') {
                                op_price += 1000;
                            }

                            //4. ìˆ˜ëŸ‰

                            /* í˜•íƒœì†Œ ë¶„ì„ê¸° ë¦¬ìŠ¤íŠ¸ ë‹¤ ë¹¼ê³  ìˆ«ìë§Œ ë‚¨ì€ ê±¸ ìˆ˜ëŸ‰ìœ¼ë¡œ ì¸ì‹? - ì¼ë‹¨ ì ì‹œ ë³´ë¥˜*/
                            /* for (var x = 0; x < morpheme_list.length; x++) {
                                for (var num = 1; num < 10; num++)
                                    if (morpheme_list[x].indexOf(String(num)) == 0) //1~9ê°€ ì†í•˜ëŠ” ë¬¸ìì—´ì´ ìˆìœ¼ë©´ 0
                                    {
                                        console.log("ìˆ˜ëŸ‰: ", Number(morpheme_list[x]));
                                        var ea = Number(morpheme_list[x]);
                                        //ìˆ˜ëŸ‰ ì¸ì‹ ëª»í–ˆì„ ë•Œ ì—ëŸ¬ ì²˜ë¦¬
                                        break;
                                    }
                            } */


                            //3. hot_cold -> case 3: hot/cold ë‘˜ ë‹¤ ë‹¤ ë  ë• ì–´ë–»ê²Œ í•  ê±´ì§€ ë””í´íŠ¸ ê°’ ì •í•˜ê¸°!!
                            hot_cold = user_op_list[user_op_list.length - 1][0];
                            var hot_cold_icon = "";

                            if (hot_cold == 'H') {
                                hot_cold_icon = '<i class="fa-brands fa-hotjar"></i>';
                            }
                            else if (hot_cold == 'C') {
                                hot_cold_icon = '<i class="fa-solid fa-snowflake"></i>';
                            }


                            //4. caf_amount
                            caf_amount = user_op_list[user_op_list.length - 1][1];
                            if (caf_amount != "") {
                                ul += '<li>';

                                if (caf_amount == 'CC') {
                                    ul += 'ì¹´í˜ì¸';
                                }
                                else if (caf_amount == 'CD') {
                                    ul += 'ë””ì¹´í˜ì¸';
                                }
                                else if (caf_amount == 'CH') {
                                    ul += 'í•˜í”„ë””ì¹´í˜ì¸';
                                }
                                ul += '</li>';
                            }

                            // 5. ì‹œëŸ½
                            syrup = user_op_list[user_op_list.length - 1][2];
                            if (syrup != "") {
                                ul += '<li>';

                                if (syrup[0] == 'B') {
                                    ul += 'ë°”ë‹ë¼ì‹œëŸ½';
                                }
                                else if (syrup[0] == 'H') {
                                    ul += 'í—¤ì´ì¦ë„›ì‹œëŸ½';
                                }
                                else if (syrup[0] == 'C') {
                                    ul += 'ì¹´ë¼ë©œì‹œëŸ½';
                                }

                                ul += ' +' + Number(syrup[1]) + 'íšŒ</li>';
                                op_price += 600;
                            }

                            // 6. ìƒ·
                            shot = user_op_list[user_op_list.length - 1][3];
                            if (shot != "") {
                                ul += '<li>';

                                if (shot[0] == 'S') {
                                    ul += ' +' + Number(shot[1]) + '</li>';
                                }
                                op_price += Number(shot[1]) * 600;
                            }


                            // 7. ìš°ìœ 
                            milk = user_op_list[user_op_list.length - 1][4];
                            if (milk != "") {
                                ul += '<li>';

                                if (milk == 'ML') {
                                    ul += 'ì €ì§€ë°©';
                                }
                                else if (milk == 'MN') {
                                    ul += 'ë¬´ì§€ë°©';
                                }
                                else if (milk == 'MS') {
                                    ul += 'ë‘ìœ ';
                                }
                                else if (milk == 'MO') {
                                    ul += 'ê·€ë¦¬';
                                }
                                ul += '</li>';

                                op_price += 600;
                            }

                            // 8. íœ˜í•‘
                            whip = user_op_list[user_op_list.length - 1][5];
                            if (whip != "") {
                                ul += '<li>';

                                if (whip[0] == 'E') {
                                    ul += 'ì—ìŠ¤í”„ë ˆì†Œ íœ˜í•‘í¬ë¦¼';

                                    if (whip[2] == '3') {
                                        ul += '<span>ë§ì´</span>'
                                    }
                                    else if (whip[2] == '2') {
                                        ul += '<span>ë³´í†µ</span>'
                                    }
                                    else if (whip[2] == '1') {
                                        ul += '<span>ì ê²Œ</span>'
                                    }
                                }
                                else if (whip[0] == 'W') {
                                    ul += 'íœ˜í•‘í¬ë¦¼';

                                    if (whip[1] == '3') {
                                        ul += '<span>ë§ì´</span>'
                                    }
                                    else if (whip[1] == '2') {
                                        ul += '<span>ë³´í†µ</span>'
                                    }
                                    else if (whip[1] == '1') {
                                        ul += '<span>ì ê²Œ</span>'
                                    }
                                }

                                ul += ' ì¶”ê°€ </li>';
                            }

                            // 9. ìë°”ì¹©
                            java_chip = user_op_list[user_op_list.length - 1][6];
                            if (java_chip != "") {
                                ul += '<li>';

                                if (java_chip == 'JAC') {
                                    ul += 'í†µìë°”ì¹© í† í•‘';
                                }
                                else if (java_chip == 'JC') {
                                    ul += 'ìë°”ì¹© í† í•‘';
                                }
                                ul += '</li>';

                                op_price += 600;
                            }

                            // 10. ë“œë¦¬ì¦
                            driz = user_op_list[user_op_list.length - 1][7];
                            if (driz != "") {
                                ul += '<li>';

                                if (driz[2] == 'R') {
                                    ul += 'ì¹´ë¼ë©œë“œë¦¬ì¦';
                                }
                                else if (driz[2] == 'C') {
                                    ul += 'ì´ˆì½”ë“œë¦¬ì¦';
                                }


                                if (driz[3] == '3') {
                                    ul += '<span>ë§ì´</span>'
                                }
                                else if (driz[3] == '2') {
                                    ul += '<span>ë³´í†µ</span>'
                                }
                                else if (driz[3] == '1') {
                                    ul += '<span>ì ê²Œ</span>'
                                }

                                ul += '</li>';
                                op_price += 600;
                            }

                            //ê°€ê²© ê³„ì‚°
                            menu_price = (price + op_price) * menu_ea;
                            price_list.push(menu_price);
                            total_price += menu_price;


                            ul += '</ul>'
                            forms_txt = '<tr>\
                                            <div class="row">\
                                                <div class="col-md-8">\
                                                    <td>\
                                                        <h4 class="text-center">'+ size + ')' + menu + hot_cold_icon + '</h4>\
                                                    </td>\
                                                </div>\
                                                <div class="col-md-2">\
                                                    <td>\
                                                        <h5 class="text-center">'+ menu_ea + '</h5>\
                                                    </td>\
                                                </div>\
                                                <div class="col-md-2">\
                                                    <td>\
                                                        <h5 class="text-center">'+ menu_price + '</h5>\
                                                    </td>\
                                                </div>\
                                            </div>\
                                            <div class="row">'+ ul + '</div>\
                                        </tr>';

                            forms.innerHTML = forms_txt;

                            total_real.innerHTML = total_price + ' ì›';

                            txt.innerHTML = 'ê²°ì œ ë˜ëŠ” ì¶”ê°€í•  ë©”ë‰´ë¥¼ ë§ì”€í•´ì£¼ì„¸ìš”â—';
                            var audio4 = await tts("ê²°ì œ ë˜ëŠ” ì¶”ê°€í•  ë©”ë‰´ë¥¼ ë§ì”€í•´ì£¼ì„¸ìš”!");

                            audio_once = false;

                        }
                        else //í•œ ê¸€ìë„ ì•ˆ ë“¤ì–´ì˜¤ë©´
                        {
                            txt.innerHTML = "âœ”ï¸ ì¸ì‹í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ í•œë²ˆ ë§ì”€í•´ì£¼ì„¸ìš”!";
                            var audio5 = await tts("ì¸ì‹í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ í•œë²ˆ ë§ì”€í•´ì£¼ì„¸ìš”!");
                        }
                    }


                    else // 1ë©”ë‰´ ì´ìƒ ì£¼ë¬¸ O
                    {
                        console.log("í•œë²ˆ ì´ìƒ ì£¼ë¬¸");
                        txt.innerHTML = 'ğŸ“Œ "ê²°ì œ"ë¼ê³  ë§ì”€í•˜ì‹œë©´ ì£¼ë¬¸ì´ ì¢…ë£Œë©ë‹ˆë‹¤.';

                        var stt2 = await speech_to_text();

                        if (stt2.length > 1) //í•œ ê¸€ì ì´ìƒ ë“¤ì–´ì˜¤ë©´
                        {
                            if (stt2 == "ê²°ì œ" | stt2 == "ê²°ì¬" | stt2 == "ì²«ì§¸") //ê²°ì œ ì›í•˜ë©´
                            {
                                console.log("ì£¼ë¬¸ ì¢…ë£Œ");
                                txt.innerHTML = "âœ”ï¸ ê²°ì œ ì•ˆë‚´ë¥¼ ë„ì™€ë“œë¦¬ê² ìŠµë‹ˆë‹¤";
                                var audio5 = await tts("ê²°ì œ ì•ˆë‚´ë¥¼ ë„ì™€ë“œë¦¬ê² ìŠµë‹ˆë‹¤!");
                                await new Promise((resolve, reject) => setTimeout(resolve, 1300));
                                break;
                            }
                            else //ê³„ì† ë©”ë‰´ ë°›ê³  ì‹¶ìœ¼ë©´
                            {
                                txt.innerHTML = "âœ…" + stt2;

                                /* í˜•íƒœì†Œ ë¶„ì„ê¸° ì‹¤í–‰ */
                                var stt_morpheme = await stem_analyzer(stt2);
                                console.log("ì „ì—­ í˜¸ì¶œ: ", morpheme_list); //-> [ì•„ë©”ë¦¬ì¹´ë…¸,í•˜ë‚˜]

                                /* DBì— ìˆëŠ”ì§€ ë©”ë‰´ ì¡°íšŒ */
                                for (var x = 0; x < morpheme_list.length; x++) {
                                    for (var y = 0; y < db_menu.length; y++) {
                                        if (morpheme_list[x] == db_menu[y]) {
                                            console.log('ë©”ë‰´ ì¸ì‹ ì™„ë£Œ : ');
                                            //6 hot_cold, 7 caf_amount, 8 syrup, 9 shot, 10 milk, 11 whip, 12 java_chip, 13 driz,
                                            before_list.push([db_menu[y], db_price[y], db[y][6], db[y][7], db[y][8], db[y][9], db[y][10], db[y][11], db[y][12], db[y][13]])

                                            break;
                                        }
                                        else //ë©”ë‰´ ì¸ì‹ ëª»í•¨
                                        {
                                            //...
                                        }
                                    }
                                }


                                /* ì‚¬ìš©ìê°€ ë§í•œ ì˜µì…˜ */
                                var user_hot_cold = "";
                                var user_caf_amount = "";
                                var user_syrup = "";
                                var user_shot = "";
                                var user_milk = "";
                                var user_whip = "";
                                var user_java_chip = "";
                                var user_driz = "";
                                var user_sales_rate = "";
                                var user_size = "";


                                for (var z = 0; z < morpheme_list.length; z++) {
                                    /* ì‚¬ìš©ìê°€ ë§í•œ ë©”ë‰´ ì˜µì…˜!! */
                                    //!!!!!!!!!!!!!!!!! ë‚˜ì¤‘ì— ì„ë² ë”© ì—°ê²°í•˜ë©´ case ê°’ ë°”ê¾¸ê¸°

                                    //1. ì˜¨ë„
                                    if (morpheme_list[z] == 'í•«') {
                                        user_hot_cold = "H";
                                    }
                                    else if (morpheme_list[z] == 'ì•„ì´ìŠ¤') {
                                        user_hot_cold = "C";
                                    }

                                    //ì˜ˆì™¸ì²˜ë¦¬
                                    if ((Number(before_list[before_list.length - 1][2]) == 1) && (user_hot_cold == "C")) //í•«
                                    {
                                        alert("Hotë§Œ ê°€ëŠ¥í•œ ë©”ë‰´ì…ë‹ˆë‹¤");
                                        user_hot_cold = "H";
                                    }
                                    else if ((Number(before_list[before_list.length - 1][2]) == 2) && (user_hot_cold == "H")) //ì½œë“œ
                                    {
                                        alert("Coldë§Œ ê°€ëŠ¥í•œ ë©”ë‰´ì…ë‹ˆë‹¤");
                                        user_hot_cold = "C";
                                    }

                                    //ì•„ë¬´ ê°’ë„ ì•ˆë“¤ì–´ì˜¤ë©´
                                    if (user_hot_cold == "") {
                                        if (Number(before_list[before_list.length - 1][2]) == 1) {
                                            user_hot_cold = "H";
                                        }
                                        else if (Number(before_list[before_list.length - 1][2]) == 2) {
                                            user_hot_cold = "C";
                                        }
                                        else if (Number(before_list[before_list.length - 1][2]) == 3) {
                                            //ë‘˜ ë‹¤ ê°€ëŠ¥í•˜ë©´ Iceë¡œ!
                                            user_hot_cold = "C";
                                        }
                                    }

                                    //2. ì¹´í˜ì¸ ì¡°ì ˆ
                                    if (morpheme_list[z] == 'ì¹´í˜ì¸') {
                                        user_caf_amount = 'CC';
                                    }
                                    else if (morpheme_list[z] == 'ë””ì¹´í˜ì¸') {
                                        user_caf_amount = 'CD';
                                    }
                                    else if (morpheme_list[z] == 'í•˜í”„ë””ì¹´í˜ì¸') {
                                        user_caf_amount = 'CH';
                                    }

                                    //ì˜ˆì™¸ì²˜ë¦¬
                                    if ((before_list[before_list.length - 1][3] == 'False') && (user_caf_amount != "")) //ì¹´í˜ì¸ ì¡°ì ˆ ë¶ˆê°€ëŠ¥
                                    {
                                        alert("ì¹´í˜ì¸ ì¡°ì ˆì´ ë¶ˆê°€ëŠ¥í•œ ë©”ë‰´ì…ë‹ˆë‹¤");
                                        user_caf_amount = "";
                                    }

                                    //3. ì‹œëŸ½ ì¡°ì ˆ
                                    if ((morpheme_list[z] == 'ë°”ë‹ë¼') || (morpheme_list[z] == 'ë°”ë‹ë¼ì‹œëŸ½')) {
                                        if (Number(morpheme_list[z + 1] != NaN)) {
                                            user_syrup = 'B' + Number(morpheme_list[z + 1])
                                        }
                                        else {
                                            user_syrup = 'B2';
                                        }
                                    }
                                    else if ((morpheme_list[z] == 'í—¤ì´ì¦ë„›') || (morpheme_list[z] == 'í—¤ì´ì¦ë„›ì‹œëŸ½')) {
                                        if (Number(morpheme_list[z + 1] != NaN)) {
                                            user_syrup = 'H' + Number(morpheme_list[z + 1])
                                        }
                                        else {
                                            user_syrup = 'H2';
                                        }
                                    }
                                    else if ((morpheme_list[z] == 'ì¹´ë¼ë©œ') || (morpheme_list[z] == 'ì¹´ë¼ë©œì‹œëŸ½')) {
                                        if (Number(morpheme_list[z + 1] != NaN)) {
                                            user_syrup = 'C' + Number(morpheme_list[z + 1])
                                        }
                                        else {
                                            user_syrup = 'C2';
                                        }
                                    }

                                    //ì˜ˆì™¸ì²˜ë¦¬
                                    if (Number(before_list[before_list.length - 1][4] == 0) && (user_syrup != "")) //ì‹œëŸ½ ì¡°ì ˆ ë¶ˆê°€ëŠ¥
                                    {
                                        alert("ì‹œëŸ½ ì¡°ì ˆì´ ë¶ˆê°€ëŠ¥í•œ ë©”ë‰´ì…ë‹ˆë‹¤");
                                        user_syrup = "";
                                    }


                                    //4. ìƒ· ì¡°ì ˆ -> ì„ ì—†ì• ê¸°
                                    if ((morpheme_list[z] == 'ìƒ·') || (morpheme_list[z] == 'ì„')) {
                                        if (Number(morpheme_list[z + 1] != NaN)) {
                                            user_shot = 'S' + Number(morpheme_list[z + 1])
                                        }
                                        else {
                                            user_shot = 'S1';
                                        }
                                    }

                                    //ì˜ˆì™¸ì²˜ë¦¬
                                    if ((before_list[before_list.length - 1][5] == 'False') && (user_shot != "")) //ìƒ· ì¡°ì ˆ ë¶ˆê°€ëŠ¥
                                    {
                                        alert("ìƒ· ì¡°ì ˆì´ ë¶ˆê°€ëŠ¥í•œ ë©”ë‰´ì…ë‹ˆë‹¤");
                                        user_shot = "";
                                    }


                                    //5. ìš°ìœ  ì¡°ì ˆ
                                    if (morpheme_list[z].indexOf('ì €ì§€ë°©') >= 0) { //indexOf í¬í•¨ ë¬¸ìì—´ ìˆìœ¼ë©´ í•´ë‹¹ ì¸ë±ìŠ¤, ì—†ìœ¼ë©´ -1 ë°˜í™˜
                                        user_milk = 'ML';
                                    }
                                    else if (morpheme_list[z].indexOf('ë¬´ì§€ë°©') >= 0) {
                                        user_milk = 'MN';
                                    }
                                    else if (morpheme_list[z].indexOf('ë‘ìœ ') >= 0) {
                                        user_milk = 'MS';
                                    }
                                    else if ((morpheme_list[z].indexOf('ê·€ë¦¬') >= 0) || (morpheme_list[z].indexOf('ì˜¤íŠ¸') > 0)) {
                                        user_milk = 'MO';
                                    }

                                    //ì˜ˆì™¸ì²˜ë¦¬
                                    if ((before_list[before_list.length - 1][6] == 'False') && (user_milk != "")) //ìš°ìœ  ì¡°ì ˆ ë¶ˆê°€ëŠ¥
                                    {
                                        alert("ìš°ìœ  ì¡°ì ˆì´ ë¶ˆê°€ëŠ¥í•œ ë©”ë‰´ì…ë‹ˆë‹¤");
                                        user_milk = "";
                                    }


                                    //6. íœ˜í•‘ ì¡°ì ˆ
                                    if (morpheme_list[z].indexOf('íœ˜í•‘') >= 0) {

                                        //ì—ìŠ¤í”„ë ˆì†Œ íœ˜í•‘ì¸ì§€ ê·¸ëƒ¥ íœ˜í•‘ì¸ì§€
                                        if (morpheme_list[z - 1] == 'ì—ìŠ¤í”„ë ˆì†Œ') {
                                            user_whip = 'EW';
                                        }
                                        else {
                                            user_whip = 'W';
                                        }

                                        // ì–‘ì€ ì–¼ë§ˆë‚˜ í• ê±´ì§€
                                        if (morpheme_list[z + 1].indexOf('ë§') >= 0) {
                                            user_whip += '3';
                                        }
                                        else if ((morpheme_list[z + 1] == 'ì ê²Œ') || (morpheme_list[z + 1] == 'ì¡°ê¸ˆ') || (morpheme_list[z + 1] == 'ì•½ê°„')) {
                                            user_whip += '1';
                                        }
                                        else { //ë§ ì•ˆí•˜ë©´ ë³´í†µ
                                            user_whip += '2';
                                        }
                                    }

                                    //ì˜ˆì™¸ì²˜ë¦¬
                                    if ((before_list[before_list.length - 1][7] == 'False') && (user_whip != "")) //íœ˜í•‘ ì¡°ì ˆ ë¶ˆê°€ëŠ¥
                                    {
                                        alert("íœ˜í•‘ ì¡°ì ˆì´ ë¶ˆê°€ëŠ¥í•œ ë©”ë‰´ì…ë‹ˆë‹¤");
                                        user_whip = "";
                                    }


                                    //7. ìë°”ì¹© ì¡°ì ˆ
                                    if (morpheme_list[z].indexOf('ìë°”ì¹©') >= 0) {
                                        if ((morpheme_list[z - 1].indexOf('í†µ') >= 0) || (morpheme_list[z].indexOf('í†µ') >= 0) || (morpheme_list[z + 1].indexOf('í†µ') >= 0)) {
                                            user_java_chip = 'JCA'; //í†µìë°”ì¹© í† í•‘
                                        }
                                        else {
                                            user_java_chip = 'JC'; //ì¼ë°˜ ìë°”ì¹© í† í•‘
                                        }
                                    }

                                    //ì˜ˆì™¸ì²˜ë¦¬
                                    if ((before_list[before_list.length - 1][8] == 'False') && (user_java_chip != "")) //ìë°”ì¹© ì¡°ì ˆ ë¶ˆê°€ëŠ¥
                                    {
                                        alert("ìë°”ì¹© ì¡°ì ˆì´ ë¶ˆê°€ëŠ¥í•œ ë©”ë‰´ì…ë‹ˆë‹¤");
                                        user_java_chip = "";
                                    }


                                    //8. ë“œë¦¬ì¦ ì¡°ì ˆ
                                    if (morpheme_list[z].indexOf('ë“œë¦¬ì¦') >= 0) {

                                        //ì¹´ë¼ë©œì¸ì§€ ì´ˆì½œë¦¿ì¸ì§€
                                        if ((morpheme_list[z - 1] == 'ì¹´ë¼ë©œ') || (morpheme_list[z] == 'ì¹´ë¼ë©œ')) {
                                            user_driz = 'DCR';
                                        }
                                        else {
                                            user_driz = 'DCC';
                                        }

                                        // ì–‘ì€ ì–¼ë§ˆë‚˜ í• ê±´ì§€
                                        if (morpheme_list[z + 1].indexOf('ë§') >= 0) {
                                            user_whip += '3';
                                        }
                                        else if ((morpheme_list[z + 1] == 'ì ê²Œ') || (morpheme_list[z + 1] == 'ì¡°ê¸ˆ') || (morpheme_list[z + 1] == 'ì•½ê°„')) {
                                            user_whip += '1';
                                        }
                                        else if (morpheme_list[z + 1] == 'ë³´í†µ') {
                                            user_whip += '2';
                                        }
                                        else { //ë§ ì•ˆí•˜ë©´ ë³´í†µ
                                            user_whip += '2';
                                        }
                                    }

                                    //ì˜ˆì™¸ì²˜ë¦¬
                                    if ((before_list[before_list.length - 1][9] == 'False') && (user_driz != "")) //ë“œë¦¬ì¦ ì¡°ì ˆ ë¶ˆê°€ëŠ¥
                                    {
                                        alert("ë“œë¦¬ì¦ ì¡°ì ˆì´ ë¶ˆê°€ëŠ¥í•œ ë©”ë‰´ì…ë‹ˆë‹¤");
                                        user_driz = "";
                                    }


                                    //9. ì‚¬ì´ì¦ˆ
                                    if (morpheme_list[z] == 'ìˆ') {
                                        user_size = "S";
                                    }
                                    else if (morpheme_list[z] == 'í†¨') {
                                        user_size = "T";
                                    }
                                    else if (morpheme_list[z] == 'ê·¸ë€ë°') {
                                        user_size = "G";
                                    }

                                    //ì•„ë¬´ ê°’ë„ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’
                                    if (user_size == "") {
                                        user_size = "T";
                                    }
                                }

                                //user_op_list = (ì˜¨ë„)H/C, (ì¹´í˜ì¸)CC/CH/CD, (ì‹œëŸ½)Bìˆ«ì/Hìˆ«ì/Cìˆ«ì, 
                                //(ìƒ·)Sìˆ«ì, (ìš°ìœ )ML/MN/MS/MO, (íœ˜í•‘)EW1~3/W1~3, (ìë°”ì¹©)JCA/JC, (ë“œë¦¬ì¦)DCR1~3/DCC1~3, (ì‚¬ì´ì¦ˆ) S/T/G

                                user_op_list.push([user_hot_cold, user_caf_amount, user_syrup, user_shot, user_milk, user_whip,
                                    user_java_chip, user_driz, user_size]);

                                console.log("ì‚¬ìš©ìê°€ ì¶”ê°€í•œ ì˜µì…˜ : ", user_op_list);



                                var audio3 = await tts(before_list[before_list.length - 1][0]/* menu_list[menu_list.length - 1] */ + "\në©”ë‰´ë¥¼ ì„ íƒí•˜ì…¨ìŠµë‹ˆë‹¤!");

                                console.log('ì¶”ê°€ëœ ë©”ë‰´', before_list[before_list.length - 1][0]);
                                console.log('ë©”ë‰´ ê°€ê²©', before_list[before_list.length - 1][1]);
                                console.log('ì¶”ê°€ëœ ì˜µì…˜', user_op_list);

                                /* ì‹¤ì œ ì˜µì…˜ */
                                var menu = "";
                                var price = "";
                                var menu_ea = 1;

                                var hot_cold = "";
                                var caf_amount = "";
                                var syrup = "";
                                var shot = "";
                                var milk = "";
                                var whip = "";
                                var java_chip = "";
                                var driz = "";
                                var sales_rate = "";
                                var size = "";
                                var ul = "<ul>";
                                var op_price = 0;


                                //6 hot_cold, 7 caf_amount, 8 syrup, 9 shot, 10 milk, 11 whip, 12 java_chip, 13 driz,
                                /* before_list.push([db_menu[y], db_price[y], db[y][6], db[y][7], db[y][8], db[y][9], db[y][10], db[y][11], db[y][12], db[y][13]]) */

                                /* var after_list = new Array();  */
                                //ì‹¤ì œ ì£¼ë¬¸ ì™„ì„± ë¦¬ìŠ¤íŠ¸ [ë©”ë‰´ì´ë¦„, ê°€ê²©, ìˆ˜ëŸ‰, ì˜¨ë„, ì¹´í˜ì¸, ì‹œëŸ½, ìƒ·, ìš°ìœ , íœ˜í•‘, ìë°”ì¹©, ë“œë¦¬ì¦, ì‚¬ì´ì¦ˆ, ì˜µì…˜ê°€ê²©, ì´ê°€ê²©]

                                //1,2,3. ë©”ë‰´ì´ë¦„, ê°€ê²©, ì‚¬ì´ì¦ˆ
                                menu = before_list[before_list.length - 1][0];
                                price = Number(before_list[before_list.length - 1][1]);
                                size = user_op_list[user_op_list.length - 1][8];

                                if (size == 'T') {
                                    op_price += 500;
                                }
                                else if (size == 'G') {
                                    op_price += 1000;
                                }

                                //4. ìˆ˜ëŸ‰

                                /* í˜•íƒœì†Œ ë¶„ì„ê¸° ë¦¬ìŠ¤íŠ¸ ë‹¤ ë¹¼ê³  ìˆ«ìë§Œ ë‚¨ì€ ê±¸ ìˆ˜ëŸ‰ìœ¼ë¡œ ì¸ì‹? - ì¼ë‹¨ ì ì‹œ ë³´ë¥˜*/
                                /* for (var x = 0; x < morpheme_list.length; x++) {
                                    for (var num = 1; num < 10; num++)
                                        if (morpheme_list[x].indexOf(String(num)) == 0) //1~9ê°€ ì†í•˜ëŠ” ë¬¸ìì—´ì´ ìˆìœ¼ë©´ 0
                                        {
                                            console.log("ìˆ˜ëŸ‰: ", Number(morpheme_list[x]));
                                            var ea = Number(morpheme_list[x]);
                                            //ìˆ˜ëŸ‰ ì¸ì‹ ëª»í–ˆì„ ë•Œ ì—ëŸ¬ ì²˜ë¦¬
                                            break;
                                        }
                                } */


                                //3. hot_cold -> case 3: hot/cold ë‘˜ ë‹¤ ë‹¤ ë  ë• ì–´ë–»ê²Œ í•  ê±´ì§€ ë””í´íŠ¸ ê°’ ì •í•˜ê¸°!!
                                hot_cold = user_op_list[user_op_list.length - 1][0];
                                var hot_cold_icon = "";

                                if (hot_cold == 'H') {
                                    hot_cold_icon = '<i class="fa-brands fa-hotjar"></i>';
                                }
                                else if (hot_cold == 'C') {
                                    hot_cold_icon = '<i class="fa-solid fa-snowflake"></i>';
                                }


                                //4. caf_amount
                                caf_amount = user_op_list[user_op_list.length - 1][1];
                                if (caf_amount != "") {
                                    ul += '<li>';

                                    if (caf_amount == 'CC') {
                                        ul += 'ì¹´í˜ì¸';
                                    }
                                    else if (caf_amount == 'CD') {
                                        ul += 'ë””ì¹´í˜ì¸';
                                    }
                                    else if (caf_amount == 'CH') {
                                        ul += 'í•˜í”„ë””ì¹´í˜ì¸';
                                    }
                                    ul += '</li>';
                                }

                                // 5. ì‹œëŸ½
                                syrup = user_op_list[user_op_list.length - 1][2];
                                if (syrup != "") {
                                    ul += '<li>';

                                    if (syrup[0] == 'B') {
                                        ul += 'ë°”ë‹ë¼ì‹œëŸ½';
                                        op_price += 600;
                                    }
                                    else if (syrup[0] == 'H') {
                                        ul += 'í—¤ì´ì¦ë„›ì‹œëŸ½';
                                        op_price += 600;
                                    }
                                    else if (syrup[0] == 'C') {
                                        ul += 'ì¹´ë¼ë©œì‹œëŸ½';
                                        op_price += 600;
                                    }

                                    ul += ' +' + Number(syrup[1]) + 'íšŒ</li>';
                                }

                                // 6. ìƒ·
                                shot = user_op_list[user_op_list.length - 1][3];
                                if (shot != "") {
                                    ul += '<li>';

                                    if (shot[0] == 'S') {
                                        ul += ' +' + Number(shot[1]) + '</li>';
                                    }
                                    op_price += Number(shot[1]) * 600;
                                }


                                // 7. ìš°ìœ 
                                milk = user_op_list[user_op_list.length - 1][4];
                                if (milk != "") {
                                    ul += '<li>';

                                    if (milk == 'ML') {
                                        ul += 'ì €ì§€ë°©';
                                    }
                                    else if (milk == 'MN') {
                                        ul += 'ë¬´ì§€ë°©';
                                    }
                                    else if (milk == 'MS') {
                                        ul += 'ë‘ìœ ';
                                    }
                                    else if (milk == 'MO') {
                                        ul += 'ê·€ë¦¬';
                                    }
                                    ul += '</li>';

                                    op_price += 600;
                                }

                                // 8. íœ˜í•‘
                                whip = user_op_list[user_op_list.length - 1][5];
                                if (whip != "") {
                                    ul += '<li>';

                                    if (whip[0] == 'E') {
                                        ul += 'ì—ìŠ¤í”„ë ˆì†Œ íœ˜í•‘í¬ë¦¼';

                                        if (whip[2] == '3') {
                                            ul += '<span>ë§ì´</span>'
                                        }
                                        else if (whip[2] == '2') {
                                            ul += '<span>ë³´í†µ</span>'
                                        }
                                        else if (whip[2] == '1') {
                                            ul += '<span>ì ê²Œ</span>'
                                        }
                                    }
                                    else if (whip[0] == 'W') {
                                        ul += 'íœ˜í•‘í¬ë¦¼';

                                        if (whip[1] == '3') {
                                            ul += '<span>ë§ì´</span>'
                                        }
                                        else if (whip[1] == '2') {
                                            ul += '<span>ë³´í†µ</span>'
                                        }
                                        else if (whip[1] == '1') {
                                            ul += '<span>ì ê²Œ</span>'
                                        }
                                    }

                                    ul += ' ì¶”ê°€ </li>';
                                }

                                // 9. ìë°”ì¹©
                                java_chip = user_op_list[user_op_list.length - 1][6];
                                if (java_chip != "") {
                                    ul += '<li>';

                                    if (java_chip == 'JAC') {
                                        ul += 'í†µìë°”ì¹© í† í•‘';
                                    }
                                    else if (java_chip == 'JC') {
                                        ul += 'ìë°”ì¹© í† í•‘';
                                    }
                                    ul += '</li>';

                                    op_price += 600;
                                }

                                // 10. ë“œë¦¬ì¦
                                driz = user_op_list[user_op_list.length - 1][7];
                                if (driz != "") {
                                    ul += '<li>';

                                    if (driz[2] == 'R') {
                                        ul += 'ì¹´ë¼ë©œë“œë¦¬ì¦';
                                        op_price += 600;
                                    }
                                    else if (driz[2] == 'C') {
                                        ul += 'ì´ˆì½”ë“œë¦¬ì¦';
                                        op_price += 600;
                                    }


                                    if (driz[3] == '3') {
                                        ul += '<span>ë§ì´</span>'
                                    }
                                    else if (driz[3] == '2') {
                                        ul += '<span>ë³´í†µ</span>'
                                    }
                                    else if (driz[3] == '1') {
                                        ul += '<span>ì ê²Œ</span>'
                                    }

                                    ul += '</li>';
                                }

                                //ê°€ê²© ê³„ì‚°
                                menu_price = (price + op_price) * menu_ea;
                                price_list.push(menu_price);
                                total_price += menu_price;


                                ul += '</ul>'
                                forms_txt += '<tr>\
                                            <div class="row">\
                                                <div class="col-md-8">\
                                                    <td>\
                                                        <h4 class="text-center">'+ size + ')' + menu + hot_cold_icon + '</h4>\
                                                    </td>\
                                                </div>\
                                                <div class="col-md-2">\
                                                    <td>\
                                                        <h5 class="text-center">'+ menu_ea + '</h5>\
                                                    </td>\
                                                </div>\
                                                <div class="col-md-2">\
                                                    <td>\
                                                        <h5 class="text-center">'+ menu_price + '</h5>\
                                                    </td>\
                                                </div>\
                                            </div>\
                                            <div class="row">'+ ul + '</div>\
                                        </tr>';

                                forms.innerHTML = forms_txt;

                                total_real.innerHTML = total_price + ' ì›';

                                txt.innerHTML = '"ê²°ì œ" / "ì¶”ê°€í•  ë©”ë‰´"ë¥¼ ë§ì”€í•´ì£¼ì„¸ìš”â—';
                                var audio4 = await tts("ê²°ì œ ë˜ëŠ” ì¶”ê°€í•  ë©”ë‰´ë¥¼ ë§ì”€í•´ì£¼ì„¸ìš”~");
                            }
                        }
                        else //í•œ ê¸€ìë„ ì•ˆ ë“¤ì–´ì˜¤ë©´
                        {
                            txt.innerHTML = "âœ”ï¸ ì¸ì‹í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ í•œë²ˆ ë§ì”€í•´ì£¼ì„¸ìš”!";
                            var audio5 = await tts("ì¸ì‹í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ í•œë²ˆ ë§ì”€í•´ì£¼ì„¸ìš”!");
                        }



                        //location.href="/client/end"; -> í’€ê¸°!!!!!!!!!!!!!!!
                    }
                }
            }

            catch (error) {
                console.log(error);
            }

        }

        /* STT */
        var isRecognizing = false;

        try {
            var recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition || window.mozSpeechRecognition || window.msSpeechRecognition)();
        }
        catch (e) {
            console.error(e);
        }

        recognition.lang = 'ko-KR';
        recognition.interimResults = false;
        recognition.maxAlternatives = 50; //í´ìˆ˜ë¡ ë°œìŒëŒ€ë¡œ ì•ˆì ê³  ë¬¸ì¥ ì í•©ë„ë¡œ.
        recognition.continuous = false; //ìŒì„±ì¸ì‹ ì•ˆëë‚˜ê³  ê³„ì†ë¨

        async function speech_to_text() {
            var resText = "";
            var txt = document.getElementById("ai_say");
            recognition.start();
            isRecognizing = true;

            recognition.onstart = function () {
                console.log("------------------------ìŒì„±ì¸ì‹ ì‹œì‘------------------------");
            }

            recognition.onresult = function (event) {
                resText = event.results[0][0].transcript;
                txt.innerHTML = resText;

                if (resText == "ê²°ì œ" | resText == "ê²°ì œ.") {
                    console.log("ê²°ì œë¼ê³  ë§í•¨");
                    return "ê²°ì œ";
                }

                console.log('STT ë°˜í™˜:', resText);

            };

            await new Promise(resolve =>
                recognition.onend = e => {
                    {
                        console.log("------------------------ìŒì„±ì¸ì‹ ì¢…ë£Œ------------------------");
                        resolve();
                    }
                })

            recognition.stop();

            resText = resText.replace(".", "");
            return resText;
        }


        /* TTS */
        var voices = [];


        function setVoiceList() {
            voices = window.speechSynthesis.getVoices();
        }
        if (window.speechSynthesis.onvoiceschanged !== undefined) {
            window.speechSynthesis.onvoiceschanged = setVoiceList;
        }


        async function tts(txt) {
            var end = false;

            if (!window.speechSynthesis) {
                alert("ìŒì„± ì¬ìƒì„ ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¸Œë¼ìš°ì €ì…ë‹ˆë‹¤. í¬ë¡¬, íŒŒì´ì–´í­ìŠ¤ ë“±ì˜ ìµœì‹  ë¸Œë¼ìš°ì €ë¥¼ ì´ìš©í•˜ì„¸ìš”");
                return;
            }

            var lang = 'ko-KR';
            var utterThis = new SpeechSynthesisUtterance(txt);

            utterThis.text = txt;
            utterThis.lang = lang;
            utterThis.pitch = 1;
            utterThis.rate = 1; //ì†ë„

            //ê¸°ì¡´
            utterThis.onerror = function (event) {
                console.log('error', event);
            };

            var voiceFound = false;

            for (var i = 0; i < voices.length; i++) {
                if (voices[i].lang.indexOf(lang) >= 0 || voices[i].lang.indexOf(lang.replace('-', '_')) >= 0) {
                    utterThis.voice = voices[i];
                    voiceFound = true;
                }
            }
            if (!voiceFound) {
                alert('voice not found');
                return;
            }

            await new Promise(function (resolve) {
                utterThis.onend = resolve;
                window.speechSynthesis.speak(utterThis);
            });
        }

    </script>



    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa"
        crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.5/dist/umd/popper.min.js"
        integrity="sha384-Xe+8cL9oJa6tN/veChSP7q+mnSPaj5Bcu9mPX5F5xIGE0DVittaqT5lorf0EI7Vk"
        crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.min.js"
        integrity="sha384-ODmDIVzN+pFdexxHEHFBQH3/9/vQ9uori45z4JjnFsRydbmQbmL5t1tQ0culUzyK"
        crossorigin="anonymous"></script>




</body>

</html>